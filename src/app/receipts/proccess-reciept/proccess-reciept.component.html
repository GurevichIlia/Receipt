<mat-expansion-panel *ngIf="step === 5" class="example-headers-align mb-1" [expanded]="step === 5"
  (opened)="receiptService.setStep(5)" hideToggle>
  <mat-expansion-panel-header>
    <mat-panel-title>
      <h6>{{'Proccess receipt' | translate}}</h6>
    </mat-panel-title>
    <mat-panel-description>
      {{'Proccess receipt' | translate}}
      <mat-icon>date_range</mat-icon>
    </mat-panel-description>
  </mat-expansion-panel-header>
  <form [formGroup]="proccessReceipt" (ngSubmit)="addProccessReceiptToReceipt(proccessReceipt)">
    <div [ngClass]="changePosition()">
      <div class="row">
        <!-- <h5 class="col-12">{{'Customer Name' | translate}}: {{customerName}}</h5> -->

        <!-- <div class="col-12">
          <mat-form-field *ngIf="newCustomer === false">
            <mat-select placeholder="{{'Name suggestion' | translate}}" formControlName="customerName">
              <mat-option [value]="name" *ngFor="let name of listOfCustomersName; let i = index"
                (click)="pickSuggestedName(name)">
                {{name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <hr *ngIf="newCustomer === false">
          <mat-form-field class="col-3">
            <input matInput placeholder="{{'Customer Name' | translate}}" formControlName="customerName">
          </mat-form-field>
        </div> -->
        <div class="col-12" >
          <mat-form-field class="examplecol-12">
            <input type="text" placeholder="{{'Name of the receipt' | translate}}" aria-label="Number" matInput
              formControlName="customerName" [matAutocomplete]="Auto" required>
            <mat-autocomplete #Auto="matAutocomplete">
              <mat-option *ngFor="let name of filteredlistOfCustomersName | async; let i = index" [value]="name">
                {{name}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>

        <!-- <h5 class="col-12">{{'Name of the receipt' | translate}}: {{selectedReceiptName}}</h5> -->
        <h5 class="col-12">{{'Total amount' | translate}}: {{totalAmount | currency : ' NIS ' : number : '1.2'}}</h5>
        <mat-error *ngIf="amountError">Amount less than the amount in the store:
          {{currentlyStoreAmount | currency : ' NIS ' : number : '1.2'}}</mat-error>
      </div>
      <hr>

      <div class="row">
        <!-- <mat-form-field class="col-12">
      <input matInput placeholder="Name of customer" formControlName="customerName"> 
    </mat-form-field> -->


        <!-- <div class="col-12" [ngClass]="changePosition()">
          <mat-form-field>
            <mat-select placeholder="{{'For' | translate}}" formControlName="receiptFor" required>
              <mat-option [value]="receipt.id" *ngFor="let receipt of receiptForList">
                {{receipt.note}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div> -->
        <div class="col-12" [ngClass]="changePosition()">
          <mat-form-field class="example-full-width col-12">
            <input type="text" placeholder="{{'For' | translate}}" aria-label="Number" matInput
              formControlName="receiptFor" [matAutocomplete]="auto" required>
            <mat-autocomplete #auto="matAutocomplete">
              <mat-option *ngFor="let receipt of filteredOptions | async; let i = index" [value]="receipt.note">
                {{receipt.note}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>


        <div class="col-12">
          <mat-form-field class="col-12" required>
            <input matInput placeholder="{{'Address' | translate}}" formControlName="addressOnTheReceipt">
          </mat-form-field>


          <mat-form-field class="col-12" *ngIf="currentlyLetters.length != 0">
            <mat-select placeholder="{{'Receipt print template' | translate}}" formControlName="receiptTemplate">
              <mat-option *ngFor="let letter of currentlyLetters " [value]="letter.ThanksLetterId">
                {{letter.ThanksLetterName}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="col-12">
            <textarea matInput placeholder="{{'Textarea' | translate}}" formControlName="textarea"></textarea>
          </mat-form-field>
          <hr>
          <mat-radio-group #sendReceipt aria-labelledby="example-radio-group-label" class="example-radio-group"
            formControlName="sendTo">
            <mat-radio-button class="example-radio-button ml-1" [value]="'email'" (click)="test(proccessReceipt)">
              {{'Send to email' | translate}}
            </mat-radio-button>
            <mat-radio-button class="example-radio-button ml-1" [value]="'whatsApp'">
              {{'Send to WhatsApp' | translate}}
            </mat-radio-button>
            <mat-radio-button class="example-radio-button ml-1 " [value]="'dontSend'" (click)="test(proccessReceipt)">
              {{'Do not send' | translate}}
            </mat-radio-button>
          </mat-radio-group>
          <mat-form-field class="col-12" *ngIf="sendReceiptTo === 'email'">
            <input matInput placeholder="{{'Email' | translate}}" formControlName="sendToEmail">
          </mat-form-field>
          <mat-form-field class="col-12" *ngIf="sendReceiptTo === 'whatsApp'">
            <input matInput placeholder="{{'Mobile phone' | translate}}" formControlName="sendToPhone">
          </mat-form-field>
          <hr>
          <mat-radio-group #showOnScreen aria-labelledby="example-radio-group-label" class="example-radio-group"
            formControlName="showOnScreen">
            <mat-radio-button class="example-radio-button" [value]="true">
              {{'Show receip on screen' | translate}}
            </mat-radio-button>
            <mat-radio-button class="example-radio-button ml-1" [value]="false">
              {{'Do not show' | translate}}
            </mat-radio-button>
          </mat-radio-group>
        </div>

      </div>
    </div>
  </form>
  <mat-action-row>
    <button mat-raised-button color="accent" class="mr-1 ml-2" (click)="receiptService.prevStep()">
      {{'Previous' | translate}}
    </button>
    <button type="button" mat-raised-button color="primary" [disabled]="proccessReceipt.invalid"
      (click)="receiptService.sendReceiptToServer(); addProccessReceiptToReceipt(proccessReceipt)">
      {{'Finish' | translate}}
    </button>

  </mat-action-row>
</mat-expansion-panel>

<div *ngIf="step === 6 || step === 6 ">
  <h2>Receipt success</h2>
  <button mat-raised-button color="primary"
    (click)="createNewReceipt()">{{'Create the new Receipt' | translate}}</button>
</div>